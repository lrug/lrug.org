# LRUG.ORG

This repo contains the website of the London Ruby User Group.  It is deployed to
[http://lrug.org][lrug].

The website is a [ruby][] application written using the
[middleman][] framework.  Most of the content is written in
[markdown][] and rendered by [kramdown][].

## Requirements

1. [Ruby][] - the current version is declared in the `ruby` declaration in
   [the `Gemfile` file in the repo](Gemfile).
2. [Bundler][] - the most current version available is likely to be best,
   but you can check the exact version in the `BUNDLED_WITH` statement at the
   bottom of [the `Gemfile.lock` file in the repo](Gemfile.lock)
3. Other dependencies are installed by bundler based on the contents of the
   [`Gemfile`](Gemfile.lock) and [`Gemfile.lock`](Gemfile.lock) files in the
   repo.

## Building

It's a standard middleman app so:

1. Clone the repo locally
2. Install dependencies with `bundle install`
3. Run the application locally with `bundle exec middleman`

## Contributing

Fork the repo and create a Pull Request with your changes.  More info in [our
contributing guidelines](CONTRIBUTING.md).

## Deploying

Commits to master are automatically deployed to [the live site][lrug].

We use [travis ci][travis] to build and deploy the site.  Our [travis
project][travis-lrug] is controlled by our [travis config](.travis.yml).

On branches the deploy script simply runs `bundle exec middleman build` and
reports success or failure with that process.  On the master branch it also
deploys the website as follows:

1. travis runs `bundle exec middleman build`
2. travis zips up the `public` folder generated by this build
3. travis uploads this zip as a build artefact called `lrug.org.tar.bz2` on the
   [travis-release][travis-release] branch of this repo (replacing any existing
   artefact with the same name).
4. travis makes a web request to [our deploy script](deploy-lrug.cgi) which
   is hosted at: `http://webhook.lrug.org/deploy-lrug.cgi`
5. the deploy script downloads the `lrug.org.tar.bz2` build artefact from the
   [travis-release][travis-release] branch on github, unpacks it and copies it
   into the right location on the webserver

[lrug]: http://lrug.org/
[ruby]: https://www.ruby-lang.org/en/
[middleman]: https://middlemanapp.com/
[markdown]: https://kramdown.gettalong.org/quickref.html
[kramdown]: https://kramdown.gettalong.org/
[bundler]: https://bundler.io/
[travis]: https://app.travis-ci.com/
[travis-lrug]: https://app.travis-ci.com/github/lrug/lrug.org/
[travis-release]: https://github.com/lrug/lrug.org/releases/tag/travis-release
